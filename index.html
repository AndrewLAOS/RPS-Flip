<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Epic Whimsical RPS Shop Game</title>
  <link href="https://fonts.googleapis.com/css2?family=Comfortaa&display=swap" rel="stylesheet" />
  <style>
    /* Reset and base */
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      font-family: 'Comfortaa', cursive, 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: radial-gradient(circle at top left, #b1d1ff, #5472d3);
      color: #222;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      padding: 2rem 1rem;
      user-select:none;
    }
    h1 {
      color: #1e2a50;
      font-weight: 900;
      font-size: 2.8rem;
      margin-bottom: 0.3em;
      text-shadow: 0 0 12px #7799ffcc;
      letter-spacing: 0.05em;
    }
    #container {
      background: linear-gradient(145deg, #ffffffdd, #dbe6ffdd);
      border-radius: 24px;
      box-shadow: 0 24px 48px rgba(30, 42, 80, 0.3);
      max-width: 520px;
      width: 100%;
      padding: 2.4rem 3rem;
      display: flex;
      flex-direction: column;
      position: relative;
      user-select:none;
    }
    .nav-buttons {
      display: flex;
      justify-content: center;
      gap: 26px;
      margin-bottom: 1.6rem;
    }
    .nav-buttons button {
      cursor: pointer;
      border: none;
      border-radius: 26px;
      padding: 0.75rem 2.4rem;
      font-weight: 700;
      font-size: 1.15rem;
      background: linear-gradient(145deg, #8eacef, #5076d9);
      color: white;
      box-shadow: 0 6px 20px #4868bbcc;
      transition: background 0.3s ease, box-shadow 0.3s ease;
      outline-offset: 4px;
      user-select:none;
    }
    .nav-buttons button:hover:not(.active) {
      background: linear-gradient(145deg, #a6b9f8, #3859b3);
      box-shadow: 0 10px 28px #274498cc;
    }
    .nav-buttons button.active {
      background: linear-gradient(145deg, #394dc6, #1a2d85);
      box-shadow: 0 14px 36px #192c83cc;
      font-weight: 900;
      letter-spacing: 0.05em;
    }

    #coin-display {
      font-weight: 900;
      font-size: 1.25rem;
      color: #1a1f38;
      margin-bottom: 1.2rem;
      letter-spacing: 0.05em;
      user-select:none;
      text-shadow: 0 0 6px #92a9ffcc;
    }

    /* Choices container */
    .choices {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 16px;
      margin-bottom: 1.6rem;
      min-height: 110px;
      user-select:none;
    }
    button.choice {
      background: linear-gradient(145deg, #e0e8ff, #c4d7ff);
      border-radius: 18px;
      border: 3px solid transparent;
      padding: 18px 22px;
      width: 100px;
      height: 100px;
      cursor: pointer;
      font-weight: 800;
      font-size: 22px;
      color: #1e2a78;
      box-shadow: 0 3px 8px #9bb3ff88;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 6px;
      transition:
        transform 0.35s cubic-bezier(0.4,0,0.2,1),
        box-shadow 0.3s ease,
        border-color 0.3s ease,
        color 0.3s ease,
        background 0.3s ease;
      user-select:none;
      text-shadow: 0 0 4px #a0bfffbb;
      outline-offset: 4px;
    }
    button.choice:focus-visible {
      outline: 3px solid #5472d3;
    }
    button.choice:disabled {
      cursor: not-allowed;
      opacity: 0.45;
      box-shadow: none;
      border-color: transparent;
      color: #777;
      background: #d3dbf0;
    }
    button.choice:hover:not(:disabled) {
      background: linear-gradient(145deg, #d1defe, #aec3ff);
      color: #0f1d50;
      box-shadow:
        0 10px 24px #5179ffcc,
        inset 0 0 18px #5179ffcc;
      border-color: #1e2a78;
      transform: scale(1.22) translateY(-6px);
      text-shadow: 0 0 7px #5f7bffcc;
    }
    .choice-icon {
      font-size: 50px;
      user-select:none;
      line-height: 1;
      text-shadow: 0 0 14px #5179ffbb;
    }

    /* Results text */
    .results {
      font-weight: 700;
      min-height: 3.2em;
      font-size: 1.2rem;
      color: #213262;
      text-shadow: 0 0 5px #9abaffcc;
      margin-bottom: 1.8rem;
      user-select:none;
    }

    /* Scoreboard */
    .scoreboard {
      display: flex;
      justify-content: space-around;
      font-size: 1.1rem;
      margin-bottom: 1.6rem;
      color: #2a3c70;
      user-select:none;
      font-weight: 700;
      letter-spacing: 0.04em;
      text-shadow: 0 0 4px #8eacefcc;
    }
    .scoreboard div {
      background: #a6b9f8;
      padding: 0.7rem 1.8rem;
      border-radius: 14px;
      box-shadow: inset 0 0 8px #4f61b4cc;
      min-width: 120px;
    }

    /* Shop styles */
    #shop {
      display: none;
      flex-direction: column;
      gap: 1.4rem;
      max-height: 320px;
      overflow-y: auto;
      padding-right: 6px;
      scroll-behavior: smooth;
      user-select:none;
    }
    #shop::-webkit-scrollbar {
      width: 8px;
    }
    #shop::-webkit-scrollbar-thumb {
      background-color: #5472d3cc;
      border-radius: 8px;
    }
    #shop::-webkit-scrollbar-track {
      background-color: #e2e9ff;
      border-radius: 8px;
    }
    #shop .rarity-section {
      font-weight: 800;
      font-size: 1.15rem;
      color: #2a3c70;
      margin-top: 14px;
      margin-bottom: 6px;
      text-shadow: 0 0 6px #9abaffcc;
      user-select:none;
      letter-spacing: 0.02em;
    }
    #shop .item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: #d4e0ff;
      border-radius: 22px;
      padding: 16px 26px;
      font-size: 1.2rem;
      cursor: pointer;
      transition: background 0.3s ease, box-shadow 0.3s ease;
      font-weight: 700;
      color: #2a3c70;
      box-shadow: inset 0 0 10px #adc5ff;
      border: 3px solid transparent;
      user-select:none;
    }
    #shop .item.disabled {
      cursor: not-allowed;
      opacity: 0.5;
      background: #becfed;
      color: #77809c;
      box-shadow: none;
      border-color: transparent;
    }
    #shop .item:hover:not(.disabled) {
      background: #5472d3;
      color: white;
      box-shadow: 0 8px 28px #3b59a7cc;
      border-color: #203d8f;
    }
    #shop .item.owned {
      background: #acc1ff;
      cursor: default;
      color: #1a2a6a;
      box-shadow: inset 0 0 30px #2d4ccfcc;
      border-color: #2e4bbf;
    }
    #shop .item .name {
      display: flex;
      align-items: center;
      gap: 18px;
      user-select:none;
    }
    #shop .item .name .icon {
      font-size: 44px;
      text-shadow: 0 0 16px #2d4ccfcc;
      user-select:none;
      line-height: 1;
    }
    #shop .item .price {
      font-weight: 900;
      min-width: 88px;
      user-select:none;
      letter-spacing: 0.05em;
    }
    /* Rarity border colors */
    .rarity-Common { border-color: #7a7a7a; }
    .rarity-Rare { border-color: #ff6f61; }
    .rarity-Epic { border-color: #7f4fa7; }
    .rarity-Legendary { border-color: #ffd93b; }

    /* Bot difficulty slider */
    #difficulty-container {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      margin-bottom: 1.8rem;
      user-select:none;
      font-weight: 700;
      color: #1a2a6a;
      text-shadow: 0 0 6px #9abaffcc;
      font-size: 1.1rem;
    }
    #difficulty-container label {
      user-select:none;
    }
    #difficulty {
      width: 180px;
      cursor: pointer;
      accent-color: #5472d3;
      height: 18px;
      border-radius: 10px;
      outline-offset: 3px;
    }
    #difficulty:focus-visible {
      outline: 2px solid #203d8f;
      outline-offset: 4px;
    }
    #difficulty-value {
      width: 48px;
      text-align: center;
      user-select:none;
      font-weight: 900;
      font-size: 1.1rem;
      color: #2a3c70;
      text-shadow: 0 0 6px #9abaffcc;
    }

    /* Animations for items */

    /* Rock - shake */
    .animate-rock {
      animation: rockShake 0.7s ease forwards;
    }
    @keyframes rockShake {
      0%, 100% { transform: rotate(0deg); }
      25% { transform: rotate(12deg); }
      50% { transform: rotate(-12deg); }
      75% { transform: rotate(10deg); }
    }

    /* Paper - flutter */
    .animate-paper {
      animation: paperFlutter 0.8s ease forwards;
    }
    @keyframes paperFlutter {
      0%, 100% { transform: translateY(0) rotate(0deg); }
      50% { transform: translateY(-12px) rotate(8deg); }
    }

    /* Scissors - cut */
    .animate-scissors {
      animation: scissorsCut 0.5s ease forwards;
    }
    @keyframes scissorsCut {
      0% { transform: rotate(0deg); }
      50% { transform: rotate(25deg) translateX(8px); }
      100% { transform: rotate(0deg) translateX(0); }
    }

    /* Fire - flicker glow */
    .animate-fire {
      animation: fireFlicker 1.2s infinite alternate ease-in-out;
    }
    @keyframes fireFlicker {
      0% { filter: drop-shadow(0 0 5px #ff6); }
      50% { filter: drop-shadow(0 0 15px #ffbb33); }
      100% { filter: drop-shadow(0 0 20px #ffcc44); }
    }

    /* Water - splash */
    .animate-water {
      animation: waterSplash 1.1s ease-in-out forwards;
    }
    @keyframes waterSplash {
      0%, 100% { transform: scale(1) translateY(0); }
      50% { transform: scale(1.25) translateY(-15px); }
    }

    /* Robot - blink */
    .animate-robot {
      animation: robotBlink 1.5s infinite ease-in-out;
    }
    @keyframes robotBlink {
      0%, 100% { filter: brightness(1); }
      50% { filter: brightness(1.75); }
    }

    /* Lightning - strike glow */
    .animate-lightning {
      animation: lightningStrike 1.1s infinite alternate ease-in-out;
    }
    @keyframes lightningStrike {
      0%, 100% { filter: drop-shadow(0 0 12px #ffd700); }
      50% { filter: drop-shadow(0 0 28px #fff200); }
    }

    /* Wind - blow */
    .animate-wind {
      animation: windBlow 1.3s ease-in-out forwards;
    }
    @keyframes windBlow {
      0%, 100% { transform: translateX(0) translateY(0); }
      50% { transform: translateX(12px) translateY(-8px) rotate(8deg); }
    }

    /* Earth - pulse */
    .animate-earth {
      animation: earthPulse 1.4s ease-in-out forwards;
    }
    @keyframes earthPulse {
      0%, 100% { box-shadow: 0 0 0 0 #8b4513cc inset; }
      50% { box-shadow: 0 0 24px 8px #8b4513cc inset; }
    }

    /* Wizard - magical glow */
    .animate-wizard {
      animation: wizardGlow 1.6s infinite alternate ease-in-out;
    }
    @keyframes wizardGlow {
      0%, 100% { filter: drop-shadow(0 0 12px #6a0dad); }
      50% { filter: drop-shadow(0 0 36px #9400d3); }
    }

    /* Dragon - fire breath */
    .animate-dragon {
      animation: dragonFire 1.5s infinite alternate ease-in-out;
    }
    @keyframes dragonFire {
      0%, 100% { filter: drop-shadow(0 0 16px #ff4500); }
      50% { filter: drop-shadow(0 0 36px #ff6347); }
    }

    /* Win animation glow */
    .win-glow {
      animation: winPulse 1.6s ease-in-out forwards;
      box-shadow: 0 0 40px 14px #5c85ffcc;
    }
    @keyframes winPulse {
      0% { box-shadow: 0 0 20px 6px #7aa7ffcc; }
      50% { box-shadow: 0 0 48px 18px #3c63ffcc; }
      100% { box-shadow: 0 0 20px 6px #7aa7ffcc; }
    }

    /* Lose animation shake */
    .lose-shake {
      animation: loseShake 0.8s ease-in-out forwards;
    }
    @keyframes loseShake {
      0%, 100% { transform: translateX(0); }
      20%, 60% { transform: translateX(-10px); }
      40%, 80% { transform: translateX(10px); }
    }
  </style>
</head>
<body>
  <div id="container" role="main" aria-label="Whimsical Rock Paper Scissors Shop Game">
    <h1>Epic Whimsical RPS Shop Game</h1>
    <div class="nav-buttons" role="tablist">
      <button id="btnGame" class="active" role="tab" aria-selected="true" aria-controls="game" tabindex="0">Game</button>
      <button id="btnShop" role="tab" aria-selected="false" aria-controls="shop" tabindex="-1">Shop</button>
    </div>

    <div id="coin-display" aria-live="polite" aria-atomic="true">Coins: <span id="coins">0</span></div>

    <!-- Bot difficulty -->
    <div id="difficulty-container">
      <label for="difficulty">Bot Difficulty:</label>
      <input type="range" id="difficulty" min="1" max="10" step="1" value="5" aria-valuemin="1" aria-valuemax="10" aria-valuenow="5" />
      <div id="difficulty-value" aria-live
="polite">5</div>
    </div>

    <!-- Game view -->
    <section id="game" role="tabpanel" tabindex="0" aria-labelledby="btnGame">
      <div class="choices" id="choices" aria-label="Choose your item to play"></div>

      <div class="scoreboard" aria-live="polite" aria-atomic="true">
        <div>Player Wins: <span id="playerScore">0</span></div>
        <div>Bot Wins: <span id="botScore">0</span></div>
      </div>

      <div class="results" id="results" role="alert" aria-live="assertive"></div>
    </section>

    <!-- Shop view -->
    <section id="shop" role="tabpanel" tabindex="0" aria-labelledby="btnShop" aria-hidden="true">
      <!-- Shop items go here -->
    </section>
  </div>

  <script>
    // Items and rarities
    const RARITY = {
      COMMON: 'Common',
      RARE: 'Rare',
      EPIC: 'Epic',
      LEGENDARY: 'Legendary',
    };

    const allItems = {
      rock: { icon: '✊', name: 'Rock', cost: 0, rarity: RARITY.COMMON, beats: ['scissors', 'fire'], color: '#A9A9A9', animationClass: 'animate-rock' },
      paper: { icon: '✋', name: 'Paper', cost: 0, rarity: RARITY.COMMON, beats: ['rock', 'robot'], color: '#FFFFFF', animationClass: 'animate-paper' },
      scissors: { icon: '✌️', name: 'Scissors', cost: 0, rarity: RARITY.COMMON, beats: ['paper', 'water'], color: '#C0C0C0', animationClass: 'animate-scissors' },
      fire: { icon: '🔥', name: 'Fire', cost: 15, rarity: RARITY.RARE, beats: ['paper', 'robot'], color: '#FF4500', animationClass: 'animate-fire' },
      water: { icon: '💧', name: 'Water', cost: 15, rarity: RARITY.RARE, beats: ['rock', 'fire'], color: '#1E90FF', animationClass: 'animate-water' },
      robot: { icon: '🤖', name: 'Robot', cost: 20, rarity: RARITY.RARE, beats: ['scissors', 'water'], color: '#708090', animationClass: 'animate-robot' },
      lightning: { icon: '⚡', name: 'Lightning', cost: 40, rarity: RARITY.EPIC, beats: ['water', 'fire', 'robot'], color: '#FFD700', animationClass: 'animate-lightning' },
      wind: { icon: '🌪️', name: 'Wind', cost: 40, rarity: RARITY.EPIC, beats: ['fire', 'rock', 'scissors'], color: '#87CEEB', animationClass: 'animate-wind' },
      earth: { icon: '🌍', name: 'Earth', cost: 45, rarity: RARITY.EPIC, beats: ['water', 'lightning'], color: '#8B4513', animationClass: 'animate-earth' },
      wizard: { icon: '🧙‍♂️', name: 'Wizard', cost: 80, rarity: RARITY.LEGENDARY, beats: ['robot', 'earth', 'scissors', 'wind'], color: '#6A0DAD', animationClass: 'animate-wizard' },
      dragon: { icon: '🐉', name: 'Dragon', cost: 100, rarity: RARITY.LEGENDARY, beats: ['wizard', 'lightning', 'fire'], color: '#FF4500', animationClass: 'animate-dragon' },
    };

    // State
    let coins = 30; // start with some coins for fun
    let playerScore = 0;
    let botScore = 0;

    // Owned items (start with base 3)
    const ownedItems = new Set(['rock', 'paper', 'scissors']);

    // Difficulty from slider (1 easiest, 10 hardest)
    let botDifficulty = 5;

    // DOM refs
    const btnGame = document.getElementById('btnGame');
    const btnShop = document.getElementById('btnShop');
    const gameView = document.getElementById('game');
    const shopView = document.getElementById('shop');
    const coinDisplay = document.getElementById('coins');
    const choicesDiv = document.getElementById('choices');
    const resultsDiv = document.getElementById('results');
    const playerScoreSpan = document.getElementById('playerScore');
    const botScoreSpan = document.getElementById('botScore');
    const difficultySlider = document.getElementById('difficulty');
    const difficultyValue = document.getElementById('difficulty-value');

    // Update UI functions
    function updateCoins() {
      coinDisplay.textContent = coins;
    }
    function updateScores() {
      playerScoreSpan.textContent = playerScore;
      botScoreSpan.textContent = botScore;
    }

    // Build choices buttons
    function buildChoices() {
      choicesDiv.innerHTML = '';
      ownedItems.forEach(key => {
        const item = allItems[key];
        const btn = document.createElement('button');
        btn.className = 'choice';
        btn.style.borderColor = item.color;
        btn.setAttribute('data-choice', key);
        btn.setAttribute('aria-label', `${item.name} choice`);
        btn.innerHTML = `<span class="choice-icon">${item.icon}</span>${item.name}`;
        btn.addEventListener('click', () => playRound(key));
        choicesDiv.appendChild(btn);
      });
    }

    // Build shop items grouped by rarity
    function buildShop() {
      shopView.innerHTML = '';

      // Group by rarity order
      const rarities = [RARITY.COMMON, RARITY.RARE, RARITY.EPIC, RARITY.LEGENDARY];

      rarities.forEach(rarity => {
        // Filter items of this rarity and not owned
        const items = Object.entries(allItems).filter(
          ([key, item]) => item.rarity === rarity && !ownedItems.has(key)
        );
        if (items.length === 0) return;

        // Rarity heading
        const rarityHeader = document.createElement('div');
        rarityHeader.textContent = rarity + ' Items';
        rarityHeader.className = 'rarity-section';
        shopView.appendChild(rarityHeader);

        items.forEach(([key, item]) => {
          const div = document.createElement('div');
          div.className = `item rarity-${rarity}`;
          if (coins < item.cost) div.classList.add('disabled');
          div.style.borderColor = item.color;
          div.innerHTML = `
            <div class="name"><span class="icon">${item.icon}</span>${item.name}</div>
            <div class="price">${item.cost}🪙</div>
          `;

          if (coins >= item.cost) {
            div.tabIndex = 0;
            div.setAttribute('role', 'button');
            div.setAttribute('aria-pressed', 'false');
            div.setAttribute('aria-label', `Buy ${item.name} for ${item.cost} coins`);
            div.addEventListener('click', () => buyItem(key));
            div.addEventListener('keydown', e => {
              if (e.key === 'Enter' || e.key === ' ') {
                e.preventDefault();
                buyItem(key);
              }
            });
          } else {
            div.tabIndex = -1;
          }

          shopView.appendChild(div);
        });
      });
    }

    // Bot picks a random item based on difficulty
    // Difficulty 1 = random easy (prefer low rarity), 10 = smart picks
    function botPick(playerChoice) {
      const keys = Object.keys(allItems);
      // Weight rarities by difficulty
      // Difficulty scale: At 1 bot picks mostly common; at 10 bot picks best counters
      const weights = {
        [RARITY.COMMON]: Math.max(1, 11 - botDifficulty * 1.5),
        [RARITY.RARE]: Math.max(0, botDifficulty - 3),
        [RARITY.EPIC]: Math.max(0, botDifficulty - 6),
        [RARITY.LEGENDARY]: Math.max(0, botDifficulty - 8),
      };

      // Build weighted array for random pick
      const weightedArr = [];

      keys.forEach(key => {
        const item = allItems[key];
        let weight = weights[item.rarity] || 1;

        // Increase weight if item beats player's choice and bot difficulty high
        if (item.beats.includes(playerChoice) && botDifficulty >= 6) {
          weight *= 3;
        }

        // Cap weight minimum 1 to ensure variety
        weight = Math.max(1, weight);

        for (let i = 0; i < weight; i++) weightedArr.push(key);
      });

      return weightedArr[Math.floor(Math.random() * weightedArr.length)];
    }

    // Determine winner of round
    function determineWinner(playerChoice, botChoice) {
      if (playerChoice === botChoice) return 'tie';
      if (allItems[playerChoice].beats.includes(botChoice)) return 'player';
      if (allItems[botChoice].beats.includes(playerChoice)) return 'bot';
      return 'tie';
    }

    // Animate item buttons on play round result
    async function animateChoices(playerChoice, botChoice, winner) {
      const playerBtn = choicesDiv.querySelector(`button[data-choice="${playerChoice}"]`);
      if (!playerBtn) return;
      const botItem = allItems[botChoice];

      // Animate player's choice
      playerBtn.classList.add(allItems[playerChoice].animationClass);
      if (winner === 'player') {
        playerBtn.classList.add('win-glow');
      } else if (winner === 'bot') {
        playerBtn.classList.add('lose-shake');
      }

      // Show bot's choice as a temporary floating element near choices
      const botBtn = document.createElement('button');
      botBtn.className = 'choice';
      botBtn.style.borderColor = botItem.color;
      botBtn.style.position = 'absolute';
      botBtn.style.top = choicesDiv.offsetTop + 5 + 'px';
      botBtn.style.left = (choicesDiv.offsetLeft + choicesDiv.offsetWidth + 20) + 'px';
      botBtn.style.pointerEvents = 'none';
      botBtn.style.width = '100px';
      botBtn.style.height = '100px';
      botBtn.style.fontWeight = '800';
      botBtn.innerHTML = `<span class="choice-icon ${botItem.animationClass}">${botItem.icon}</span>${botItem.name}`;
      document.getElementById('container').appendChild(botBtn);

      await new Promise(r => setTimeout(r, 1200));

      // Cleanup animations
      playerBtn.classList.remove(allItems[playerChoice].animationClass, 'win-glow', 'lose-shake');
      botBtn.remove();
    }

    // Play one round of game
    async function playRound(playerChoice) {
      if (!ownedItems.has(playerChoice)) return;

      disableChoices(true);
      resultsDiv.textContent = 'Bot is choosing...';

      const botChoice = botPick(playerChoice);

      await animateChoices(playerChoice, botChoice);

      const winner = determineWinner(playerChoice, botChoice);

      let resultText = '';
      if (winner === 'player') {
        playerScore++;
        coins += 12;
        resultText = `🎉 You win! ${allItems[playerChoice].name} beats ${allItems[botChoice].name}. +12🪙`;
      } else if (winner === 'bot') {
        botScore++;
        coins -= 7;
        if (coins < 0) coins = 0;
        resultText = `😞 You lose! ${allItems[botChoice].name} beats ${allItems[playerChoice].name}. -7🪙`;
      } else {
        resultText = `😐 It's a tie! Both chose ${allItems[playerChoice].name}.`;
      }
      resultsDiv.textContent = resultText;
      updateCoins();
      updateScores();
      buildShop();
      disableChoices(false);
    }

    // Disable or enable player choices
    function disableChoices(disable) {
      choicesDiv.querySelectorAll('button.choice').forEach(btn => {
        btn.disabled = disable;
      });
    }

    // Buy an item from shop
    function buyItem(key) {
      if (ownedItems.has(key)) return;
      const item = allItems[key];
      if (coins >= item.cost) {
        coins -= item.cost;
        ownedItems.add(key);
        resultsDiv.textContent = `✨ You bought ${item.name}! You can now play with it.`;
        updateCoins();
        buildChoices();
        buildShop();
      } else {
        resultsDiv.textContent = `You don't have enough coins for ${item.name}.`;
      }
    }

    // Tab toggle handlers
    function showGame() {
      btnGame.classList.add('active');
      btnGame.setAttribute('aria-selected', 'true');
      btnGame.tabIndex = 0;

      btnShop.classList.remove('active');
      btnShop.setAttribute('aria-selected', 'false');
      btnShop.tabIndex = -1;

      gameView.style.display = 'flex';
      gameView.setAttribute('aria-hidden', 'false');
      shopView.style.display = 'none';
      shopView.setAttribute('aria-hidden', 'true');
      resultsDiv.focus();
    }
    function showShop() {
      btnShop.classList.add('active');
      btnShop.setAttribute('aria-selected', 'true');
      btnShop.tabIndex = 0;

      btnGame.classList.remove('active');
      btnGame.setAttribute('aria-selected', 'false');
      btnGame.tabIndex = -1;

      shopView.style.display = 'flex';
      shopView.setAttribute('aria-hidden', 'false');
      gameView.style.display = 'none';
      gameView.setAttribute('aria-hidden', 'true');
      shopView.focus();
    }

    btnGame.addEventListener('click', showGame);
    btnShop.addEventListener('click', showShop);

    // Difficulty slider update
    difficultySlider.addEventListener('input', e => {
      botDifficulty = Number(e.target.value);
      difficultyValue.textContent = botDifficulty;
      difficultySlider.setAttribute('aria-valuenow', botDifficulty);
    });

    // Init UI
    updateCoins();
    updateScores();
    buildChoices();
    buildShop();
    showGame();

  </script>
</body>
</html>
